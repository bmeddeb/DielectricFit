<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DielectricFit - Advanced Dielectric Analysis Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }
        .bg-surface { background-color: #ffffff; }
        .bg-base { background-color: #f1f5f9; }
        .text-primary { color: #1e293b; }
        .text-secondary { color: #64748b; }
        .text-accent { color: #3b82f6; }
        .border-slate-200 { border-color: #e2e8f0; }

        .kpi-card {
            background-color: #ffffff;
            padding: 1rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: all 0.3s ease-in-out;
        }
        .kpi-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        .sidebar-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            color: #475569;
            font-weight: 500;
            transition: background-color 0.2s, color 0.2s;
            white-space: nowrap;
        }
        .sidebar-link:hover, .sidebar-link.active {
            background-color: #eef2ff;
            color: #3b82f6;
        }

        .view { display: none; }
        .view.active { display: block; }

        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }

        /* Progress steps */
        .step {
            display: inline-flex;
            align-items: center;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            color: #94a3b8;
            background-color: #f1f5f9;
            transition: all 0.2s;
            cursor: pointer;
        }
        .step.active {
            background-color: #3b82f6;
            color: white;
        }
        .step.completed {
            background-color: #10b981;
            color: white;
        }

        /* Parameter slider styles */
        .param-slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: #e2e8f0;
            outline: none;
            -webkit-appearance: none;
        }
        .param-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .param-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        /* Collapsible sidebar animations */
        .logo-text, .sidebar-link span {
            transition: opacity 0.3s, max-width 0.3s;
        }
        .w-20 #toggle-icon {
            display: none;
        }
        .w-20:hover #toggle-icon {
            display: block;
        }
        .w-20:hover #logo-icon {
            display: none;
        }
    </style>
</head>
<body class="flex h-screen bg-slate-50">

    <!-- Sidebar Navigation -->
    <aside class="w-64 bg-surface text-secondary flex-shrink-0 p-4 border-r border-slate-200 transition-all duration-300">
        <!-- Sidebar Header -->
        <div id="sidebar-header" class="flex items-center justify-between mb-8 h-8 cursor-pointer" title="Toggle Sidebar">
            <div class="flex items-center gap-2 overflow-hidden">
                <svg id="logo-icon" class="w-6 h-6 text-accent flex-shrink-0" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 12C3 9.0929 4.10331 6.31311 5.99864 4.41919C7.89438 2.52483 10.6756 1.5 13.5 1.5C16.3244 1.5 19.1056 2.52483 21.0014 4.41919C22.8967 6.31311 24 9.0929 24 12C24 14.9071 22.8967 17.6869 21.0014 19.5808C19.1056 21.4752 16.3244 22.5 13.5 22.5C10.6756 22.5 7.89438 21.4752 5.99864 19.5808C4.10331 17.6869 3 14.9071 3 12Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M13.5 5.25C12.0693 5.25 10.6963 5.76026 9.69519 6.6661C8.69408 7.57193 8.13684 8.79894 8.13684 10.05C8.13684 11.3011 8.69408 12.5281 9.69519 13.4339C10.6963 14.3397 12.0693 14.85 13.5 14.85C16.3284 14.85 18.6368 12.5415 18.6368 9.75C18.6368 8.49894 18.0796 7.27193 17.0785 6.3661C16.0774 5.46026 14.7043 4.95 13.2737 4.95L13.5 5.25Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <h1 class="text-xl font-bold text-primary logo-text">DielectricFit</h1>
            </div>
            <svg id="toggle-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-secondary hover:text-accent transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="4" stroke-width="2.5" />
                <line x1="9" y1="3" x2="9" y2="21" stroke-width="2.5" />
            </svg>
        </div>

        <nav class="space-y-2">
            <a href="#dashboard" class="sidebar-link active" data-view="dashboard">
                <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <rect x="3" y="3" width="7" height="7" rx="1" stroke-width="2"/>
                    <rect x="14" y="3" width="7" height="7" rx="1" stroke-width="2"/>
                    <rect x="3" y="14" width="7" height="7" rx="1" stroke-width="2"/>
                    <rect x="14" y="14" width="7" height="7" rx="1" stroke-width="2"/>
                </svg>
                <span>Dashboard</span>
            </a>
            <a href="#analysis" class="sidebar-link" data-view="analysis">
                <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                </svg>
                <span>Analysis</span>
            </a>
            <a href="#models" class="sidebar-link" data-view="models">
                <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                </svg>
                <span>Model Library</span>
            </a>
            <a href="#reports" class="sidebar-link" data-view="reports">
                <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V7a2 2 0 012-2h10a2 2 0 012 2v8a2 2 0 01-2 2z"></path>
                </svg>
                <span>Reports</span>
            </a>
            <div class="border-t border-slate-200 my-4"></div>
            <a href="#preferences" class="sidebar-link" data-view="preferences">
                <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
                <span>Preferences</span>
            </a>
            <a href="#profile" class="sidebar-link" data-view="profile">
                <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                </svg>
                <span>Profile</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content Area -->
    <main class="flex-1 p-4 lg:p-6 overflow-y-auto">

        <!-- Dashboard View -->
        <div id="view-dashboard" class="view active">
            <!-- Top Row: Stats and Quick Actions -->
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-4 mb-6">
                <!-- Upload Card -->
                <div class="kpi-card">
                    <label for="quick-upload" class="flex flex-col items-center justify-center h-32 border-2 border-slate-300 border-dashed rounded-lg cursor-pointer bg-base hover:bg-slate-100">
                        <svg class="w-8 h-8 mb-2 text-secondary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                        </svg>
                        <p class="text-sm text-secondary font-semibold">Upload CSV</p>
                        <p class="text-xs text-secondary">or drag & drop</p>
                        <input id="quick-upload" type="file" class="hidden" accept=".csv" />
                    </label>
                </div>

                <!-- Stats Cards -->
                <div class="kpi-card">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-primary">14</p>
                            <p class="text-sm text-secondary">Datasets</p>
                        </div>
                        <div class="p-3 bg-blue-100 rounded-lg">
                            <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V7a2 2 0 012-2h10a2 2 0 012 2v8a2 2 0 01-2 2z"></path>
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="kpi-card">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-primary">9</p>
                            <p class="text-sm text-secondary">Analyses</p>
                        </div>
                        <div class="p-3 bg-green-100 rounded-lg">
                            <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="kpi-card">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-bold text-primary">3</p>
                            <p class="text-sm text-secondary">Today</p>
                        </div>
                        <div class="p-3 bg-purple-100 rounded-lg">
                            <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Analyses Grid -->
            <h2 class="text-xl font-bold text-primary mb-4">Recent Analyses</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4">
                <!-- Analysis Card 1 -->
                <div class="kpi-card cursor-pointer hover:shadow-xl" onclick="openAnalysis('sample1')">
                    <div class="h-32 mb-3">
                        <canvas id="dashChart1"></canvas>
                    </div>
                    <div class="border-t border-slate-200 pt-3">
                        <div class="flex justify-between items-start mb-2">
                            <div>
                                <h3 class="font-semibold text-primary">Sample_PCB_01</h3>
                                <p class="text-xs text-secondary">HN Model • 2025-01-08</p>
                            </div>
                            <span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full">Complete</span>
                        </div>
                        <div class="flex justify-between text-xs text-secondary">
                            <span>RMSE: 0.0023</span>
                            <span>KK Valid: ✓</span>
                        </div>
                    </div>
                </div>

                <!-- Analysis Card 2 -->
                <div class="kpi-card cursor-pointer hover:shadow-xl">
                    <div class="h-32 mb-3">
                        <canvas id="dashChart2"></canvas>
                    </div>
                    <div class="border-t border-slate-200 pt-3">
                        <div class="flex justify-between items-start mb-2">
                            <div>
                                <h3 class="font-semibold text-primary">Polymer_Test_A</h3>
                                <p class="text-xs text-secondary">Cole-Cole • 2025-01-07</p>
                            </div>
                            <span class="px-2 py-1 bg-yellow-100 text-yellow-700 text-xs rounded-full">Processing</span>
                        </div>
                        <div class="flex justify-between text-xs text-secondary">
                            <span>RMSE: 0.0045</span>
                            <span>KK Valid: ⚠</span>
                        </div>
                    </div>
                </div>

                <!-- Analysis Card 3 -->
                <div class="kpi-card cursor-pointer hover:shadow-xl">
                    <div class="h-32 mb-3">
                        <canvas id="dashChart3"></canvas>
                    </div>
                    <div class="border-t border-slate-200 pt-3">
                        <div class="flex justify-between items-start mb-2">
                            <div>
                                <h3 class="font-semibold text-primary">Ceramic_03</h3>
                                <p class="text-xs text-secondary">DS Model • 2025-01-06</p>
                            </div>
                            <span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full">Complete</span>
                        </div>
                        <div class="flex justify-between text-xs text-secondary">
                            <span>RMSE: 0.0018</span>
                            <span>KK Valid: ✓</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analysis Workspace View -->
        <div id="view-analysis" class="view">
            <!-- Analysis Header -->
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h1 class="text-2xl font-bold text-primary">Analysis Workspace</h1>
                    <p class="text-secondary">Sample_PCB_01.csv</p>
                </div>
                <div class="flex gap-2">
                    <button class="px-4 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200">Save Progress</button>
                    <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">Export Results</button>
                </div>
            </div>

            <!-- Progress Steps -->
            <div class="flex gap-2 mb-6 overflow-x-auto">
                <div class="step completed">1. Import</div>
                <div class="step completed">2. Diagnose</div>
                <div class="step active">3. Preprocess</div>
                <div class="step">4. Model</div>
                <div class="step">5. Fit</div>
                <div class="step">6. Validate</div>
            </div>

            <!-- Analysis Content Area -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Left Panel - Controls -->
                <div class="lg:col-span-1">
                    <div class="kpi-card">
                        <h3 class="font-semibold text-primary mb-4">Preprocessing Options</h3>

                        <!-- Data Quality Indicators -->
                        <div class="mb-4 p-3 bg-green-50 border border-green-200 rounded-lg">
                            <p class="text-sm font-medium text-green-800">KK Consistency Check</p>
                            <p class="text-xs text-green-600 mt-1">Data passes causality test</p>
                        </div>

                        <!-- Preprocessing Controls -->
                        <div class="space-y-4">
                            <div>
                                <label class="text-sm font-medium text-primary">Smoothing</label>
                                <select class="w-full mt-1 p-2 border border-slate-200 rounded-lg">
                                    <option>Savitzky-Golay</option>
                                    <option>Moving Average</option>
                                    <option>None</option>
                                </select>
                            </div>

                            <div>
                                <label class="text-sm font-medium text-primary">Baseline Correction</label>
                                <div class="flex items-center mt-2">
                                    <input type="checkbox" class="mr-2" checked>
                                    <span class="text-sm text-secondary">Apply correction</span>
                                </div>
                            </div>

                            <div>
                                <label class="text-sm font-medium text-primary">Hook Correction (Cp)</label>
                                <input type="number" class="w-full mt-1 p-2 border border-slate-200 rounded-lg" placeholder="1e-12" value="1e-12">
                            </div>

                            <div>
                                <label class="text-sm font-medium text-primary">DC Conductivity</label>
                                <input type="number" class="w-full mt-1 p-2 border border-slate-200 rounded-lg" placeholder="Auto-detect" value="1.2e-10">
                            </div>
                        </div>

                        <button class="w-full mt-6 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                            Apply Preprocessing
                        </button>
                    </div>
                </div>

                <!-- Right Panel - Visualizations -->
                <div class="lg:col-span-2">
                    <div class="kpi-card">
                        <div class="grid grid-cols-2 gap-4">
                            <!-- Real Part Plot -->
                            <div>
                                <h4 class="text-sm font-medium text-primary mb-2">ε' vs Frequency</h4>
                                <div class="h-48">
                                    <canvas id="realPartPlot"></canvas>
                                </div>
                            </div>

                            <!-- Imaginary Part Plot -->
                            <div>
                                <h4 class="text-sm font-medium text-primary mb-2">ε'' vs Frequency</h4>
                                <div class="h-48">
                                    <canvas id="imagPartPlot"></canvas>
                                </div>
                            </div>

                            <!-- Cole-Cole Plot -->
                            <div>
                                <h4 class="text-sm font-medium text-primary mb-2">Cole-Cole Plot</h4>
                                <div class="h-48">
                                    <canvas id="coleColePlot"></canvas>
                                </div>
                            </div>

                            <!-- KK Residuals -->
                            <div>
                                <h4 class="text-sm font-medium text-primary mb-2">KK Residuals</h4>
                                <div class="h-48">
                                    <canvas id="kkResidualsPlot"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation Buttons -->
                    <div class="flex justify-between mt-4">
                        <button class="px-6 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200">
                            ← Previous Step
                        </button>
                        <button class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                            Next Step →
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Model Library View -->
        <div id="view-models" class="view">
            <h1 class="text-2xl font-bold text-primary mb-6">Model Library</h1>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- Multi-Pole Debye Model Card -->
                <div class="kpi-card">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-semibold text-primary">Debye (Multi-Pole)</h3>
                        <span class="px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full">Flexible</span>
                    </div>
                    <p class="text-sm text-secondary mb-3">N-pole relaxation model (N=1 for single Debye)</p>
                    <div class="text-xs text-secondary space-y-1">
                        <p>Parameters: ε∞, {Δεₖ, τₖ}ₙ, σdc</p>
                        <p>N=1: Simple dielectrics</p>
                        <p>N>1: Multiple relaxations</p>
                    </div>
                    <div class="mt-3 pt-3 border-t border-slate-200 flex items-center justify-between">
                        <div class="flex items-center gap-2">
                            <label class="text-xs text-secondary">Poles:</label>
                            <select class="text-xs border border-slate-200 rounded px-2 py-1">
                                <option>N=1</option>
                                <option>N=2</option>
                                <option>N=3</option>
                                <option>Auto</option>
                            </select>
                        </div>
                        <button class="text-sm text-blue-600 hover:text-blue-800">Use →</button>
                    </div>
                </div>

                <!-- Cole-Cole Model Card -->
                <div class="kpi-card">
                    <h3 class="font-semibold text-primary mb-2">Cole-Cole</h3>
                    <p class="text-sm text-secondary mb-3">Symmetric broadening of relaxation peak</p>
                    <div class="text-xs text-secondary space-y-1">
                        <p>Parameters: ε∞, Δε, τ, α, σdc</p>
                        <p>Best for: Polymers, composites</p>
                        <p>Depressed semicircle in plot</p>
                    </div>
                    <div class="mt-3 pt-3 border-t border-slate-200 flex justify-end">
                        <button class="text-sm text-blue-600 hover:text-blue-800">Use →</button>
                    </div>
                </div>

                <!-- Cole-Davidson Model Card -->
                <div class="kpi-card">
                    <h3 class="font-semibold text-primary mb-2">Cole-Davidson</h3>
                    <p class="text-sm text-secondary mb-3">Asymmetric peak with high-frequency tail</p>
                    <div class="text-xs text-secondary space-y-1">
                        <p>Parameters: ε∞, Δε, τ, β, σdc</p>
                        <p>Best for: Glass formers</p>
                        <p>Skewed arc in Cole-Cole plot</p>
                    </div>
                    <div class="mt-3 pt-3 border-t border-slate-200 flex justify-end">
                        <button class="text-sm text-blue-600 hover:text-blue-800">Use →</button>
                    </div>
                </div>

                <!-- HN Model Card -->
                <div class="kpi-card">
                    <h3 class="font-semibold text-primary mb-2">Havriliak-Negami</h3>
                    <p class="text-sm text-secondary mb-3">General asymmetric and broad peaks</p>
                    <div class="text-xs text-secondary space-y-1">
                        <p>Parameters: εs, ε∞, τ, α, β, σdc</p>
                        <p>Best for: Complex polymers</p>
                        <p>Encompasses CC & CD as limits</p>
                    </div>
                    <div class="mt-3 pt-3 border-t border-slate-200 flex justify-end">
                        <button class="text-sm text-blue-600 hover:text-blue-800">Use →</button>
                    </div>
                </div>

                <!-- Djordjević-Sarkar Model Card -->
                <div class="kpi-card">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-semibold text-primary">Djordjević-Sarkar</h3>
                        <span class="px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full">Wideband</span>
                    </div>
                    <p class="text-sm text-secondary mb-3">Log-domain model with nearly constant tan δ</p>
                    <div class="text-xs text-secondary space-y-1">
                        <p>Parameters: ε∞, Δε, ω₁, ω₂, σdc</p>
                        <p>Best for: PCB/substrate materials</p>
                        <p>Causal & KK-consistent</p>
                    </div>
                    <div class="mt-3 pt-3 border-t border-slate-200 flex justify-end">
                        <button class="text-sm text-blue-600 hover:text-blue-800">Use →</button>
                    </div>
                </div>

                <!-- Sarkar Model Card (Alternative formulation) -->
                <div class="kpi-card">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-semibold text-primary">Sarkar (Modified)</h3>
                        <span class="px-2 py-1 bg-orange-100 text-orange-700 text-xs rounded-full">PCB</span>
                    </div>
                    <p class="text-sm text-secondary mb-3">Frequency-dependent model for printed circuits</p>
                    <div class="text-xs text-secondary space-y-1">
                        <p>Parameters: Dk₀, Df₀, f₀, m</p>
                        <p>Dk(f) = Dk₀(f/f₀)^m</p>
                        <p>Industry standard for PCB</p>
                    </div>
                    <div class="mt-3 pt-3 border-t border-slate-200 flex justify-end">
                        <button class="text-sm text-blue-600 hover:text-blue-800">Use →</button>
                    </div>
                </div>

                <!-- Debye-Lorentz Model Card -->
                <div class="kpi-card">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-semibold text-primary">Debye-Lorentz</h3>
                        <span class="px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded-full">Hybrid</span>
                    </div>
                    <p class="text-sm text-secondary mb-3">Relaxations + resonances combined</p>
                    <div class="text-xs text-secondary space-y-1">
                        <p>Parameters: {τₖ} + {ω₀ₘ, δₘ}</p>
                        <p>Best for: Optical materials</p>
                        <p>Sharp peaks + broad features</p>
                    </div>
                    <div class="mt-3 pt-3 border-t border-slate-200 flex justify-end">
                        <button class="text-sm text-blue-600 hover:text-blue-800">Use →</button>
                    </div>
                </div>

                <!-- Multi-Debye-Lorentz Model Card -->
                <div class="kpi-card">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-semibold text-primary">Multi-Term D-L</h3>
                        <span class="px-2 py-1 bg-indigo-100 text-indigo-700 text-xs rounded-full">Advanced</span>
                    </div>
                    <p class="text-sm text-secondary mb-3">Multiple Debye + Lorentz terms</p>
                    <div class="text-xs text-secondary space-y-1">
                        <p>N Debye poles + M Lorentz</p>
                        <p>Full spectral coverage</p>
                        <p>High flexibility, more params</p>
                    </div>
                    <div class="mt-3 pt-3 border-t border-slate-200 flex justify-end">
                        <button class="text-sm text-blue-600 hover:text-blue-800">Use →</button>
                    </div>
                </div>

                <!-- Custom Model Card -->
                <div class="kpi-card border-2 border-dashed border-slate-300 bg-slate-50">
                    <div class="flex items-center justify-center h-full min-h-[150px]">
                        <div class="text-center">
                            <svg class="w-10 h-10 mx-auto mb-2 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                            </svg>
                            <h3 class="font-semibold text-primary mb-1">Custom Model</h3>
                            <p class="text-xs text-secondary">Define your own model</p>
                            <button class="mt-3 text-sm text-blue-600 hover:text-blue-800">Create →</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Model Comparison Section -->
            <div class="mt-8">
                <h2 class="text-lg font-semibold text-primary mb-4">Quick Model Selection Guide</h2>
                <div class="kpi-card">
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="border-b border-slate-200">
                                    <th class="text-left py-2 text-primary">Data Characteristic</th>
                                    <th class="text-left py-2 text-primary">Recommended Model</th>
                                    <th class="text-left py-2 text-primary">Parameters</th>
                                </tr>
                            </thead>
                            <tbody class="text-secondary">
                                <tr class="border-b border-slate-100">
                                    <td class="py-2">Single narrow peak</td>
                                    <td class="py-2 font-medium">Debye (N=1)</td>
                                    <td class="py-2">4 params</td>
                                </tr>
                                <tr class="border-b border-slate-100">
                                    <td class="py-2">Multiple distinct peaks</td>
                                    <td class="py-2 font-medium">Multi-Pole Debye</td>
                                    <td class="py-2">2N+2 params</td>
                                </tr>
                                <tr class="border-b border-slate-100">
                                    <td class="py-2">Broad symmetric peak</td>
                                    <td class="py-2 font-medium">Cole-Cole</td>
                                    <td class="py-2">5 params</td>
                                </tr>
                                <tr class="border-b border-slate-100">
                                    <td class="py-2">Asymmetric with HF tail</td>
                                    <td class="py-2 font-medium">Cole-Davidson</td>
                                    <td class="py-2">5 params</td>
                                </tr>
                                <tr class="border-b border-slate-100">
                                    <td class="py-2">Complex asymmetric</td>
                                    <td class="py-2 font-medium">Havriliak-Negami</td>
                                    <td class="py-2">6 params</td>
                                </tr>
                                <tr class="border-b border-slate-100">
                                    <td class="py-2">Nearly constant tan δ</td>
                                    <td class="py-2 font-medium">Djordjević-Sarkar</td>
                                    <td class="py-2">5 params</td>
                                </tr>
                                <tr>
                                    <td class="py-2">Relaxations + resonances</td>
                                    <td class="py-2 font-medium">Debye-Lorentz</td>
                                    <td class="py-2">Variable</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interactive Fitting View (Hidden by default, shown when in fitting stage) -->
        <div id="fitting-panel" class="view" style="display: none;">
            <div class="kpi-card">
                <h3 class="font-semibold text-primary mb-4">Interactive Parameter Fitting</h3>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Parameter Controls -->
                    <div class="space-y-4">
                        <div>
                            <div class="flex justify-between mb-1">
                                <label class="text-sm font-medium">ε∞</label>
                                <span class="text-sm text-secondary">3.5</span>
                            </div>
                            <input type="range" class="param-slider" min="2" max="5" step="0.1" value="3.5">
                        </div>

                        <div>
                            <div class="flex justify-between mb-1">
                                <label class="text-sm font-medium">Δε</label>
                                <span class="text-sm text-secondary">15.2</span>
                            </div>
                            <input type="range" class="param-slider" min="5" max="25" step="0.1" value="15.2">
                        </div>

                        <div>
                            <div class="flex justify-between mb-1">
                                <label class="text-sm font-medium">τ (log scale)</label>
                                <span class="text-sm text-secondary">1e-6</span>
                            </div>
                            <input type="range" class="param-slider" min="-8" max="-4" step="0.1" value="-6">
                        </div>

                        <div>
                            <div class="flex justify-between mb-1">
                                <label class="text-sm font-medium">α</label>
                                <span class="text-sm text-secondary">0.85</span>
                            </div>
                            <input type="range" class="param-slider" min="0.5" max="1" step="0.01" value="0.85">
                        </div>

                        <div class="flex gap-2 mt-6">
                            <button class="flex-1 px-4 py-2 bg-slate-100 text-slate-700 rounded-lg hover:bg-slate-200">Reset</button>
                            <button class="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">Auto-Fit</button>
                        </div>
                    </div>

                    <!-- Fit Metrics -->
                    <div>
                        <div class="p-4 bg-slate-50 rounded-lg">
                            <h4 class="text-sm font-medium text-primary mb-3">Fit Quality Metrics</h4>
                            <div class="space-y-2">
                                <div class="flex justify-between">
                                    <span class="text-sm text-secondary">RMSE:</span>
                                    <span class="text-sm font-medium text-primary">0.0023</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-secondary">χ²:</span>
                                    <span class="text-sm font-medium text-primary">1.24</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-secondary">R²:</span>
                                    <span class="text-sm font-medium text-primary">0.9987</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-sm text-secondary">AIC:</span>
                                    <span class="text-sm font-medium text-primary">-234.5</span>
                                </div>
                            </div>
                        </div>

                        <div class="mt-4 p-4 bg-green-50 border border-green-200 rounded-lg">
                            <p class="text-sm font-medium text-green-800">Convergence Status</p>
                            <div class="mt-2 bg-green-200 rounded-full h-2">
                                <div class="bg-green-600 h-2 rounded-full" style="width: 100%"></div>
                            </div>
                            <p class="text-xs text-green-600 mt-1">Converged successfully</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <script>
        // Initialize charts
        document.addEventListener('DOMContentLoaded', function() {
            // Sidebar toggle
            const sidebarHeader = document.getElementById('sidebar-header');
            const sidebar = document.querySelector('aside');
            const sidebarElementsToHide = sidebar.querySelectorAll('.logo-text, nav span');
            const toggleIcon = document.getElementById('toggle-icon');

            function toggleSidebar() {
                sidebar.classList.toggle('w-64');
                sidebar.classList.toggle('w-20');
                sidebarElementsToHide.forEach(el => {
                    el.classList.toggle('opacity-0');
                    el.classList.toggle('max-w-0');
                    el.classList.toggle('invisible');
                });
                toggleIcon.classList.toggle('rotate-180');
            }

            sidebarHeader.addEventListener('click', toggleSidebar);

            // View switching
            const links = document.querySelectorAll('.sidebar-link');
            const views = document.querySelectorAll('.view');

            links.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const viewId = this.getAttribute('data-view');
                    links.forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    views.forEach(view => {
                        view.classList.remove('active');
                        if (view.id === `view-${viewId}`) view.classList.add('active');
                    });
                });
            });

            // Chart configurations
            const chartOptions = {
                maintainAspectRatio: false,
                responsive: true,
                plugins: { legend: { display: false } },
                scales: {
                    x: {
                        grid: { display: false },
                        ticks: { display: false }
                    },
                    y: {
                        grid: { color: '#e2e8f0' },
                        ticks: { display: false }
                    }
                }
            };

            // Dashboard mini charts
            if (document.getElementById('dashChart1')) {
                new Chart(document.getElementById('dashChart1').getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: Array.from({length: 50}, (_, i) => i),
                        datasets: [{
                            data: Array.from({length: 50}, () => Math.random() * 10 + 5),
                            borderColor: 'rgb(59, 130, 246)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 0
                        }]
                    },
                    options: chartOptions
                });
            }

            if (document.getElementById('dashChart2')) {
                new Chart(document.getElementById('dashChart2').getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: Array.from({length: 50}, (_, i) => i),
                        datasets: [{
                            data: Array.from({length: 50}, () => Math.random() * 8 + 3),
                            borderColor: 'rgb(16, 185, 129)',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 0
                        }]
                    },
                    options: chartOptions
                });
            }

            if (document.getElementById('dashChart3')) {
                new Chart(document.getElementById('dashChart3').getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: Array.from({length: 50}, (_, i) => i),
                        datasets: [{
                            data: Array.from({length: 50}, () => Math.random() * 12 + 2),
                            borderColor: 'rgb(249, 115, 22)',
                            backgroundColor: 'rgba(249, 115, 22, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 0
                        }]
                    },
                    options: chartOptions
                });
            }

            // Analysis plots
            const analysisChartOptions = {
                maintainAspectRatio: false,
                responsive: true,
                plugins: {
                    legend: { display: false },
                    title: { display: false }
                },
                scales: {
                    x: {
                        type: 'logarithmic',
                        grid: { color: '#e2e8f0' },
                        ticks: {
                            color: '#64748b',
                            font: { size: 10 }
                        },
                        title: {
                            display: true,
                            text: 'Frequency (Hz)',
                            color: '#64748b',
                            font: { size: 11 }
                        }
                    },
                    y: {
                        grid: { color: '#e2e8f0' },
                        ticks: {
                            color: '#64748b',
                            font: { size: 10 }
                        }
                    }
                }
            };

            // Generate sample data for analysis plots
            const frequencies = Array.from({length: 50}, (_, i) => Math.pow(10, i/10 + 2));

            if (document.getElementById('realPartPlot')) {
                new Chart(document.getElementById('realPartPlot').getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: frequencies,
                        datasets: [{
                            label: "ε'",
                            data: frequencies.map(f => 10 - Math.log10(f)),
                            borderColor: 'rgb(59, 130, 246)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            pointRadius: 2
                        }]
                    },
                    options: analysisChartOptions
                });
            }

            if (document.getElementById('imagPartPlot')) {
                new Chart(document.getElementById('imagPartPlot').getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: frequencies,
                        datasets: [{
                            label: "ε''",
                            data: frequencies.map(f => 2 * Math.exp(-Math.pow((Math.log10(f) - 4)/2, 2))),
                            borderColor: 'rgb(239, 68, 68)',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            pointRadius: 2
                        }]
                    },
                    options: analysisChartOptions
                });
            }

            // Interactive parameter sliders
            document.querySelectorAll('.param-slider').forEach(slider => {
                slider.addEventListener('input', function() {
                    const value = this.value;
                    const label = this.parentElement.querySelector('span.text-secondary');
                    if (this.parentElement.querySelector('label').textContent.includes('log')) {
                        label.textContent = `1e${value}`;
                    } else {
                        label.textContent = value;
                    }
                    // Here you would trigger WebSocket update for real-time fitting
                    console.log('Parameter updated:', label.textContent);
                });
            });
        });

        // Function to open analysis (placeholder)
        function openAnalysis(sampleId) {
            document.querySelector('[data-view="analysis"]').click();
        }
    </script>
</body>
</html>